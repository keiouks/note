# https的本质

`http`的下层是`tcp`层，而`https`在`tcp`层和`http`层之间多插入了一层。

插进去的层叫`SSL/TLS`，这是两个名字。

`SSL`是很久前网景公司发明的，发展到v3版本后，被证明是很好的安全通讯协议，所以，`IETF`在1999年把它改名为`TLS`并正式标准化。

`https`的安全性就靠这个`TLS`层完成。

至于`http`的数据格式并没有变，下层也还是由`tcp`负责传输。

# TLS 安全传输的过程

现在说下安全传输的传输过程：

1，浏览器/客户端向服务器发起`https`请求；

2，服务器把`证书(包含公钥)`返回给浏览器；

3，浏览器产生用来做对称加密的随机的`对称密钥`，然后用服务器发过来的`公钥`加密，得到`加密后的对称密钥`，再把`加密后的对称密钥`发给服务器；

4，服务器用`私钥`对`加密后的对称密钥`进行解密得到`对称密钥`；

5，服务器用`对称密钥`加密要传给浏览器的数据得到`加密后的数据`，再把`加密后的数据`传给浏览器；

6，浏览器用`对称密钥`就可以解密`加密后的数据`得到数据；

7，之后浏览器和服务器就通过`对称密钥`先加密，再传给对方，对方再解密的方式进行数据通讯。

# 一些事实

1，上面过程中，只有第3步和第4步用到`非对称加密`，目的是安全地传输`对称密钥`；

2，服务器得到`对称密钥`后，后续双方地数据传输都只依赖`对称加密`;

3，第3步浏览器确实可以给服务器传`浏览器的公钥`，之后双方可以通过对方的公钥加密数据后传给对方，对方再通过对应的私钥解密得到数据。

4，没有使用`非对称加密`传输数据最重要的原因是`非对称加密`加解密数据使用比较复杂的数学运算，速度很慢，这个慢是相对于`对称加密`来说的。`对称加密`加解密只要做逆操作，速度快很多，这个速度是`非对称加密`的几百倍。

# 疑点

待续